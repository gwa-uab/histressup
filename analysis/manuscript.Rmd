---
title: Spatial and temporal variability in economic availability of residual biomass
  from timber harvest in west-central Alberta, Canada (1990--2015)
author:
- Glen W. Armstrong:
    institute: rr
    correspondence: 'yes'
    email: gwa@ualberta.ca
- Jay A. Anderson:
    email: jaya@ualberta.ca
    institute: rees
- Alex W. McPhee:
    email: awmcphee@ualberta.ca
    institute: rees
institute:
- rr: Department of Renewable Resources, University of Alberta, Edmonton AB  T6G 2H1,
    Canada
- rees: Department of Resource Economics and Environmental Sociology, University of
    Alberta, Edmonton AB  T6G 2H1, Canada
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  html_document:
    number_sections: yes
    df_print: paged
    pandoc_args:
    - --lua-filter=scholarly-metadata.lua
    - --lua-filter=author-info-blocks.lua
  word_document:
    number_sections: yes
    pandoc_args:
    - --lua-filter=scholarly-metadata.lua
    - --lua-filter=author-info-blocks.lua
  pdf_document:
    includes:
      in_header: preamble.tex
    number_sections: yes
    latex_engine: xelatex
    keep_tex: yes
    pandoc_args:
    - --lua-filter=scholarly-metadata.lua
    - --lua-filter=author-info-blocks.lua
header-includes:
- \usepackage[left]{lineno}
- \usepackage{setspace}
- \linenumbers
geometry: left=1.5in,right=0.5in,top=1in,bottom=1in
csl: biomass-and-bioenergy
bibliography: historicalResidueSupply.bib
---

\raggedright
<!-- \fontfamily{cmr} -->
<!-- \fontsize{12}{22} -->
<!-- \fontseries{b} -->
<!-- \selectfont -->

```{r setup, include=FALSE, echo = FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, echo=FALSE, message=FALSE}
setwd("g:/Shared drives/FES_Data_Sharing_Forestry/Manuscripts/histressupp/analysis")
#setwd("/mnt/chromeos/GoogleDrive/SharedDrives/FES_Data_Sharing_Forestry/Manuscripts/histressupp/analysis")
library(tidyverse)
library(ggthemes)
library(gridExtra)
library(viridis)
library(skimr)
library(scales)
library(DescTools)
library(zoo)
library(ezknitr)
library(magick)
library(kableExtra)
library(gt)
library(glue)
```


\newpage
\doublespacing

# Introduction

1. **Focus on cost variability associated with transportation and forest  characteristics**
2. **Based on historical harvest locations (1990-2015)**

Need to reference Yemshanov @Yemshanov2014 and Blackburn @Blackburn2020a.  Our
strengths

1. Availability of data
2. Temporal variability
3. suitability for mid-level analysis
4. ultra-cool graphics


<!-- ## Some obvious citations -->

<!-- @Carriquiry2011 -->

<!-- @Dessbesell2017 -->

<!-- @Dymond2010 -->

<!-- @Lo2021 -->

<!-- @Malladi2018 -->

<!-- @Mansuy2017 -->

<!-- @Mansuy2020 -->

<!-- @Schroder2019 -->

<!-- @Shabani2013 -->

<!-- @Shooshtarian2018 -->

<!-- @Yemshanov2018 -->

<!-- @Zheng2021 -->

<!-- @Ackom2010 -->

<!-- @Acuna2019 -->



## Justification


* renewable fuels better than fossil fuels
* forest harvest residue just piled and burned
* forest road networks in Alberta radiate from location
* terrain is difficult
* simple circle or doughnut models of limited utility

# Materials and methods



## Data sources

We used a number of publicly available datasets to develop the datasets
used in our analysis.  Most of the data are freely available on the World
Wide Web (WWW). Much of the data processing required for this study was 
manipulation of spatial
data.  This was done using the QGIS software @QGISorg2021.
All national level data were clipped to the Alberta provincial boundary
for further analysis.

The datasets are only introduced here.  The way they are used will be discussed
in detail later.

### Altalis

Altalis manages much of the spatial data created by or for the Government of
Alberta.  We use several coverages from their base features database product 
@Altalis2021:
the provincial, green/white area, forest management unit (FMU), forest management
agreement area (FMAA), Alberta Township Survey System
township, and town
boundaries.

The Alberta Township Survey System (ATS) is particularly important to this study
as all the data used for this study are aggregated or disaggregated to the
township level.  ATS provides the basis for legal land descriptions in Alberta.
The typical township is roughly square (9.778 km by 9.716 km, 9 500 ha) and 
is indexed by
township (1--126), range (1--30), and meridian (4--6) numbers.  
The townships immediately east of
Alberta's western boundary, and immediately east of the 5^th^ and 6^th^
meridians (corresponding to 114°W and 118°W longitude, respectively) are 
partial townships and therefore deviate from the roughly square shape.  ATS
is described in detail by the Alberta Land Surveyor's Association @ALSA2021.
There are 7 237 townships in Alberta.  That allow for pretty good spatial 
resolution.



### Alberta Geospatial Services

Alberta Geospatial Services is operated by the Alberta Ministry of Environment
and Parks @Alberta2021a.  We obtained the road access coverages from here.  The
road access coverages available from Altalis do not have as detailed information
on road class as those available from Alberta Geospatial Services.

### National Forest Information System

As part of Canada's National Forest Inventory, the National Forest Information
System (NFIS) provides a web-based individual tree biomass calculator @NFIS2021. 
It 
is used to calculate stem wood, stem bark, branch, and foliage biomass for 
a tree based on province, ecozone, species, diameter at breast height (dbh) and
height.  It is possible to upload a file representing many trees with different
combinations of these input parameters and download a file containing the
calculated results for all the trees.

NFIS has also produced a set of spatial data layers representing forest 
properties at a 250 m resolution for all of Canada @Beaudoin2017.  We used the
merchantable volume, stand age, and species composition attributes from these 
data layers.  

Another product of NFIS is a set of spatial datasets derived from satellite data 
@NFIS2021b.  The dataset used for this study is the harvest year data set for
the years 1985-2015.  The dataset is described in detail by Hermosilla *et al.*
@Hermosilla2016.  Essentially, it consists of a raster for Canada at 30 m 
resolution indicating the year of harvest for each cell.

### Natural Resources Canada

For our study, the most important product of Natural Resources Canada is
the Ung *et al.* paper @Ung2013 which describes the tree taper models 
developed for Canada.  A valuable contribution related to this is the WWW-based
wood volume calculator that uses those models @NRCan2015.  It is helpful for
understanding how taper functions work.

### National Forestry Database

The national forestry database @CCFM2020 was used to summarize the 
timber harvest volume from
Alberta for the years 1990-2015.

### Forest management plans

The Alberta government requires FMA holders to develop a forest management
plan for their FMAA.
The forest management plans were used to get information on utilization 
standards and piece size of harvested trees @Alberta2021. 


### Miscellaneous

The map of provincial boundaries comes from Statistics Canada @Canada2016.

The boundaries of Canada's terrestrial ecozones, which are important inputs to
the biomass calculator can be found on Agriculture and Agri-Food Canada's
web site @Canada2017.


## Study area

Alberta is a province in western Canada.  It occupies 661 848 km^2^.
Its southern boundary is 49°N latitude, northern boundary is 60°N latitude,
eastern boundary is 110°W longitude, and its western boundary is defined by
120°W longitude and the Great Divide of the Rocky Mountains.

The southeastern part of the province is largely privately owned agricultural
land, but the northern and western parts are largely publicly owned forest land.
There is a substantial area of privately owned agricultural land
in the Peace River Country of northwestern Alberta.  
There are also substantial areas
in National Parks along the Rocky Mountains and in the far north of the 
province.  The province calls the area of mostly publicly owned forest land 
as the Green Area, and the area of mostly privately owned agricultural land 
as the White Area.  About 90% of the harvested timber volume in Alberta
comes from the Green Area.

For administrative purposes, the Green Area is divided into Forest Management
Units (FMUs).  The province also enters into long term agreements with forestry
companies giving the companies the rights to timber harvest and the 
responsibility to manage the forest sustainably.  These agreements are
called Forest Management Agreements, and the areas under agreement are
called Forest Management Agreement Areas (FMAAs).  For the most part, the
boundaries of the FMAAs are now coincident with FMU boundaries, with
the exception that the Alberta-Pacific FMAA in eastern Alberta comprises
12 FMUs.
<!-- FMAAs occupy 62% of the Green Area **and maybe something about proportion of -->
<!-- harvest** -->

Our focus for this study is the forest near Hinton, Edson, and Whitecourt in 
west-central Alberta.  These towns were chosen as they host several
forest products companies and are located near very active FMAAs.
We assume that it would be likely that a forest residue processing plant
would be located near an existing forest products mill as the forest road
network has been developed to supply those mills, and location of a residue
plant near a forest products mill would also allow for access to 
mill residues.  Figure ?? shows the location of the three towns in 
relation to FMAAs and the Green and White Areas.

The FMAAs which supply most of the timber to mills in our near our three 
locations are West Fraser Mills Ltd. (Hinton), West Fraser Mills Ltd. (Edson),
Weyerhaeuser Company Limited (Pembina Timberlands), Millar Western, Blue
Ridge Lumber Inc., and ANC Timber Ltd.

For this study, we assumed that forest harvest residue processing would take
place at a plant co-located with an existing forest products manufacturing
facility. We used the Weyerhaeuser oriented strand board plant in Edson, the
Millar Western Forest Products Ltd. pulp mill in Whitecourt, and the West Fraser
pulp mill in Hinton as the locations for the hypothetical forest residue
processing facilities.

As well as considering locations for the hypothetical plants, we considered 3
different plant capacities: 200 Gg/a  corresponding to a small wood pellet
mill, 400 Gg/a  corresponding to a large pellet mill or a small ethanol
plant, and 800 Gg/a  corresponding to a large ethanol plant.



## Harvested area

The areas harvested in Alberta in 2009 according to NFIS @NFIS2021b
@Hermosilla2016 are shown in relationship to the three towns and 
the Green Area in Figure 3.  Our data set includes harvest areas for the
years 1990--2015, so this is just an example.


Figure 4 shows the proportion of the township area harvested in 2009 aggregated
to the township level, showing only those townships where the proportion of
the township area harvested was greater than 0.001.  For each township, and
each of the years between 1990 and 2015, we store the area harvested (ha) for
use in our analysis.  We can see from this map that a great deal of timber
harvest took place near our plant locations in 2009.



## Cycle time estimates


The provincial road network was sorted into four classes: primary highways,
other paved roads, two-lane gravel roads, and one-lane gravel or dirt roads.  
Loaded and unloaded travel speeds were assumed for each road class, according
to the table below. The harmonic mean of loaded and unloaded speeds 
(rounded to the nearest
multiple of 5 km/h) were calculated as
$$
\bar{s_h}= \left(\frac{s_l^{-1} + s_u^{-1}}{2}\right)^{-1}
$$
where $s_l$ is the loaded speed and $s_u$ is the unloaded speed.
Use of harmonic mean allows us to calculate the correct  cycle time:  the
time required to travel from the mill, to the collection site in the forest,
and back to the mill.  This provides the basis for our estimates of haul cost.
Calculating average haul speed using an arithmetic mean leads to a biased
estimate of cycle time.





<!-- Check out https://haozhu233.github.io/kableExtra/awesome_table_in_html.html to -->
<!-- try to format this table better. -->

Figure 6 illustrates the road network in Alberta and estimates of one-way haul
time based on the average of loaded and unloaded speeds from Table ??. The
road network in the White Area of the province is very dense and largely arranged
as a grid related to the Alberta Township Survey System.  Most of the roads
in the White Area are public.  The road network in the Green Area is much
less dense and many of the roads are built and maintained by resource industries 
(*e.g.* forestry and petroleum & natural gas).  The one-way haul times were
generated using the QGIS Network Analysis Toolbox 3 plugin (QNEAT3) created by 
Raffler @Raffler2018,
specifically its iso-area as interpolation (from point) algorithm.  In our case,
we used the algorithm to determine the minimum one-way travel time along the road network 
from each
of our centres to each cell of a provincial level raster at a 200 m resolution.  Travel time
was calculated based on the harmonic mean of loaded and unloaded times for each
road segment.  Off-road travel was assumed to be at 5 km/h.  The underlying
algorithm for travel time minimization is that of Dijkstra @Dijkstra1959.


QGIS zonal statistics were used to calculate the median network travel time to
each township, from each of our three centres.  The one-way travel time in Figure
6 was limited to 6 hours because this equates to a 13 hour cycle time if
you assume 1 hour for loading and unloading.  In Alberta, drivers of commercial
vehicles are not permitted to drive more than 13 hours in a day.  **technically
we could take the picture out to 6.5 hours, as the loading and unloading time
does not count as driving time.  There is an on-duty limit of 14 hours**.

```{r constants, echo=FALSE, include=FALSE}
#hourly_truck_rate <- 175 + 225 + 40 #place holder.
# info fromhttps://www.rogerstrucking.ca/services/rates-and-equipment/62-tractor-truck-hourly-rates
# 175 $/hr for tractor, 225 for walking floor trailer, 40 for operator

#hourly_truck_rate <- 175 # adjusted from Roger's numbers to be more in line with Roeser
trailer_capacity <- 100 #m^3 from https://www.newtontrailers.com/trailer_hire/biomass_moving_floor_trailer/-/54/0
#hourly_truck_rate <- 175.90 #$/hr
hourly_truck_rate <- 157.31 #$/hr tandem tractor with tandem trailer
#hourly_truck_rate <- 108.82 #$/hr
#solid_volume_factor <- 0.4 #from fortsv5
solid_volume_factor <- 0.3 #from fortsv5
adj_trailer_capacity <- trailer_capacity * solid_volume_factor
specific_gravity <- 0.38 #lodgepole pine
odt_trailer <- specific_gravity * adj_trailer_capacity
truck_rate <- hourly_truck_rate / odt_trailer

#truck_rate <- 6.43 # $/odt/hr
prepiling_cost <- 6.30 # $/odt
#comminution_cost <- 25.60 # $/odt
comminution_cost <- 26.82 # $/odt (Blackburn2020a)
other_cost <- 8.48 # $/odt
constant_cost <- prepiling_cost +  comminution_cost + other_cost # $·Mg^-1^ 
location <- c('Whitecourt','Edson','Hinton')
capacity <- c(200000,400000,800000)

merch_vol_adj_factor <- 2.77 # based on a wild ass guess
#merch_vol_adj_factor <- 2.38 #based on West Fraser Hinton
odmt_adj_factor <-  0.10

#get prop of dec/con by twp
standing_time <- 60

```
### Utilization standards

Many forest products companies operate in Alberta, and have different agreements
with the government with respect to how the forest is managed.  Some companies
have harvesting rights to just the needleleaf species, others have rights to
just the broadleaf species, and some have rights to both needleleaf and
broadleaf.

Utilization standards in Alberta are specified on the basis of stump height,
minimum stump diameter (outside bark), and minimum log length to a specified top
diameter (inside bark).  Utilization standards vary by FMU.  Stump heights used
in Alberta are 15 and 30 cm; stump diameters are 13 or 15 cm; top diameters are
7, 10, 11, or 12 cm; and minimum log lengths are 2.44, 2.66, 2.67, 3.66, 3.76, 
or 4.88 m.  These utilization standards are necessary to relate volumes 
calculated to the 13/7 standard for the National Forest Inventory to the harvest
volumes reported by the companies.  Perhaps most importantly, the minimum top
diameter will have an effect on the volume of residue left in the forest 
corresponding to the tops of trees.



## Biomass collection costs

All measures of biomass (Mg) used in this study are reported on
a dry matter basis.

We assume that the biomass available for collection at a cutblock includes the
tops, branches, and foliage left at a roadside landing after processing by
a stroke delimber.  The delimber is assumed to top the log at the top diameter
specified in the utilization standard relevant to the harvest area.  Recovery
will not be perfect.  We assume a recovery factor of 0.624 
following Peltola *et al.* 
@Peltola2011, recognizing that some of the residual biomass will 
be unrecoverable.

Our focus in this study is on the spatial and temporal variation in biomass
collection costs based on residue availability associated with cycle times.  Following Röser @Roser2013, the pre-piling cost was set to
`r sprintf("%5.2f",prepiling_cost)` \$·Mg^-1^ , the comminution cost (@Blackburn2020a)
was set to `r sprintf("%5.2f",comminution_cost)`  \$·Mg^-1^ , and other costs
(roads, supervision, overhead, maintenance, and compliance) were
set to  `r sprintf("%5.2f",other_cost)` \$·Mg^-1^ .  The total cost,
excluding transport, is
`r sprintf("%5.2f",constant_cost)` \$·Mg^-1^ .

We assume that the residue will be transported from the forest using a 
live floor chip van with 100 m³ capacity.
The USDA Forest Service's Forest Residue Transportation Costing Model 
@Rummer2005 assumes a default solid volume factor of 0.3 for biomass meaning that
a 100 m³ capacity trailer could hold the equivalent of 30 m³ of solid biomass.

This equates to `r sprintf("%5.2f",odt_trailer)` Mg
of biomass assuming a specific gravity of `r sprintf("%5.2f",specific_gravity)` 
which is the specific gravity of lodgepole pine wood and bark on a green volume basis 
according to Miles and Smith @Miles2009a.

Timber Tracks produces a publication describing forestry equipment hourly rates
@TT2020.  The rate reported for 
#an 8 axle tridem tractor with a b-train trailer was
tandem tractor with a tandem trailer was
`r sprintf("%5.2f",hourly_truck_rate)` \$/h.  We assume that
the tractor-trailer combination used to haul biomass would cost a 
similar amount.

Therefore, the cost of transporting residual biomass was set to 
`r sprintf("%5.2f",truck_rate)` \$·Mg^-1^·h^-1^.


<!-- ## Hypothetical plant locations and capacities -->
<!-- Location stuff based on Onyango @Onyango2019. -->

<!-- There are a number of companies with Forest Management Agreement Areas -->
<!-- located near Edson, Whitecourt, and Hinton. -->
<!-- The West Fraser Mills Ltd. (Hinton) FMAA is the primary timbershed for the -->
<!-- Hinton Wood Products sawmill and the Hinton Pulp pulp mill.  The West Fraser Mills Ltd. (Hinton) FMA is the primary timbershed for the Edson Forest Products  -->
<!-- sawmill.  The Weyerhaeuser Company Limited (Pembina Timberlands) FMAA supplies  -->
<!-- the Edson oriented strand board mill and the Drayton Valley sawmill.  The  -->
<!-- Weyerhaeuser Company Limited (Pembina Timberlands) FMAA supplies sawmills in Whitecourt and Fox Creek, a pulp mill -->
<!-- in Whitecourt, and a specialty wood products facility and Acheson.  The Blue -->
<!-- Ridge Lumber Inc. FMAA supplies a sawmill in Blue Ridge, which is about 23 km  -->
<!-- from Whitecourt.  The ANC Timber Ltd. FMAA supplies logs to several sawmills in -->
<!-- the area, in exchange for chips used to feed the Alberta Newsprint -->
<!-- Company newsprint mill in Whitecourt. -->

<!-- ```{r west_central_ab, echo=FALSE, fig.cap="Location of Forest Management Agreement Areas serving Hinton, Edson, and Whitecourt.", out.width = '80%'} -->
<!-- knitr::include_graphics("../img/west_central_AB_2.png") -->
<!-- ``` -->



### Terrestrial ecozone map

Most
of the timber harvest in Alberta occurs in the Boreal Plain, but some occurs
in the Montane Cordillera and Taiga Plain.


The NFIS' individual tree biomass calculator @NFIS2016 uses province, ecozone, 
species, dbh, and height as input variables, so ecozone is important.  It is based on 
equations developed by Lambert
*et al.* (2005) @Lambert2005.

## Spatial variability in residual biomass production

There is considerable spatial variability in the amount of timber harvest
residues available for biomass collection.  The variability relates to the
distribution of harvested species and age classes across the landscape, to the
timber harvesting practices of different operators, and to other factors.
We used the 250 m resolution raster maps of Canada's forest attributes for 2011
from Natural Resources Canada @Beaudoin2017 to retrieve information on species
composition, age classes, and merchantable volume.  The data were clipped to the
Alberta boundary.  Merchantable volumes for Alberta in this dataset were
compiled to a 13/7 utilization standard, meaning that stump height was assumed
to be 30 cm, that stump diameter (outside bark) needed to be at least 13 cm, and
that the length of the log to a 7 cm inside bark diameter must be at least 4.88
m for a log to be merchantable.  This is one of the utilization standards used
in Alberta and was used for Canada's National Forest Inventory (NFI henceforth)
@Boudewyn2007.

The first step was to identify cells that contained merchantable forest
inventory. We selected cells that contained at least 50 m^3^/ha of merchantable
volume, as that corresponds with merchantability limits specified in Alberta
@Alberta2016. We filtered out cells with more than 50% crown closure of larch
(*Larix spp.* Mill.) and birch (*Betula spp.* L.) as those genera are rarely harvested at
a commercial scale in Alberta.  We filtered out cells with stand age less than
80 years as it is unusual to harvest stands younger than that in Alberta.
This filtered raster was "unioned" with the township coverage, and an average of
the merchantable volume in the merchantable cells was calculated.  This volume
was adjusted upwards by the ratio of the average volume per hectare harvested
from the West Fraser (Hinton) Forest Management Agreement Area (FMA) to the
average merchantable volume for each township calculated from the filtered
raster and township coverages.  The multiplicative volume adjustment factor was
calculated as `r sprintf("%5.2f",merch_vol_adj_factor)`.  

**A little more explanation is needed..**

Something about needleleaf and broadleaf trees.  Most common species harvested
are white spruce (*Picea glauca* (Moench) Voss), lodgepole pine 
(*Pinus contorta* var. *latifolia* Engelm.), jack pine 
(*Pinus banksiana* Lamb.), trembling aspen (*Populus tremuloides* Michx.),
and less commonly black spruce 
(*Picea mariana* (Mill.) Britton, Sterns & Poggenburg), Engelmann spruce 
(*Picea engelmannii* 
Parry ex Engelm.),  balsam poplar
(*Populus balsamifera* L.), 
balsam fir (*Abies balsamea* (L.) Mill.),  
subalpine fir (*Abies lasiocarpa* (Hooker) Nuttall), 
and Rocky Mountain Douglas-fir 
(*Pseudotsuga menziesii* var. *glauca*  (Mayr) Franco).


# Theory/Calculation

This is a second best analysis.  Detailed information on harvest volumes
tied to spatial location is held by the provincial government as scale records.
Real (as opposed to modelled) forest inventory information is collected by
holders of forest management agreements as Alberta Vegetation Inventory.
Despite the fact that forest harvesting occurs mostly on public land, the
government considers this information to be the property of companies, and 
requires the consent of companies to release it to researchers.  There are
currently 21 Forest Management Agreements in Alberta.  Permission would need 
to be obtained from the holders of each of those FMAs as well as smaller
companies that operate sawmills.

The GIS analysis for this paper was done using QGIS @QGISorg2021.  Data
summaries and statistical analysis were done using R @R2021 with RStudio
@RStudioTeam2021, and tidyverse @Wickham2019.

## Residue yield (Mg·ha^-1^ ) by township.


### Merchantable volume township 

1. Filter out unmerchantable cells from 250 m data
   1. age < 80 years
   2. merchantable volume < 50 m^3^/ha based on 13+/7 cm utilization standard
   8. Bw + Lt prop > 50
2. average merchantable volume of remaining cells to the township level
3. adjust average inventory volume to actual harvested volume from the 
national forestry database @CCFM2021.
   - average volume/ha harvested / inventory volume = 2.77
   
### Tree characteristics

Most of he forest management plans prepared by FMA holders include projections
of average harvested pieces size, for both needleleafed and broadleafed trees,
if relevant.  We used the piece size reported for the
first 5-year period of the 200-year planning horizon. 

We used the harvest piece sizes reported in the detailed forest management
plans for the townships in each FMAA.  For those areas where piece size was
not reported we assumed an average piece size of 0.278 m^3^ for needleleafed
trees and 0.264 m^3^ for broadleafed trees.  These are the average of the values
reported in the forest management plans.  These values are based on the 
utilization
standards used on the FMA.

Utilization standards vary by FMA, and are specified as combinations of 
stump height, stump diameter (outside bark), and minimum log length to a 
specified top diameter.  Stump heights used include 15 cm and 30 cm; stump 
diameters include 15 and 13 cm; top diameters include 12, 11, 10, and 7 cm;
minimum log lengths include 2.44, 2.67, 3.66, 3.76, and 4.88 m.  For areas 
outside of FMAAs we use 30 cm stump height, 15 cm minumum stump diameter, 11
cm top for needleleafed trees and 10 cm top for broadleafed trees, and a 4.88
m minimum log length.  These correspond to the default utilization standards
specified in the Alberta timber harvest planning and operating ground rules
@Alberta2016.

Every township has a leading needleleafed and broadleafed species and
a proportion of merchantable volume associated 
with it derived from the 250 m resolution national inventory @Beaudoin2017.

Ung *et al.* @Ung2013 present taper models and the associated coefficients
for the tree species found in Canada.  These taper models can be used to
find the diameter at any point along the main bole of a tree given species
and diameter at breast height (DBH).  DBH is a commonly used tree measurement
and is the diameter of the tree measured at 1.3 m above ground level, in
most jurisdictions.  It is straightforward to determine cross-sectional area
of the tree at any height.  Integrating this area function will yield volume
between any two heights.

$$
d(d_b,h) = \left(d^2_{b} \frac{\beta_0 d_{b}^{\beta_1}}{\beta_0 d_{b}^{\beta_1} - 1.3} \left(\frac{h}{1.3}\right)^{2-\beta_2}\right)^{-2}
$$

where $d$ is the diameter (cm) at height $h$ (m), and $d_b$ is the diameter at
breast height (1.3 m above ground level)

Implicit in this equation is an equation for tree height


$$
H(d_b) = \beta_0 d_b ^ {\beta_1}
$$


The cross-sectional area equation

$$
r(d_b,h) = \frac{d(d_b,h)}{200}
$$

The constant 200 is used to convert a diameter (cm) to a radius (m). 

$$
a(d_b,h) = \pi r(d_b,h)^2
$$

$$
v(d_b,h_s,h_t) = \int_{h_s}^{h_t} \pi r(d_b,h)^2 dh
$$

 

There is also a simple linear model relating outside bark to inside bark diameter.  The
taper function is for outside bark diameter, but piece sizes are reported
as inside bark volume.  Binary search is used to find the height associated
with the inside bark diameter specified in the utilization standard.

Every combination of township and FMU has a piece size for needleleafed and
broadleafed associated with it, and the leading needleleafed and broadleafed 
species.  We used a binary search procedure to find dbh and height of the 
"average" broadleafed and needleleafed tree in each township based on the 
companies utilization standard.  An average piece size to the 13+/7 utilization
standard was also calculated by integrating the area function using the 
appropriate limits.

Using these equations, we are able to calculate wood volumes and bark volumes
between any two heights along the tree stem.  We calculate the proportions 
of total tree and bark volumes in the top of the tree.  We use this volume 
proportion later to calculate biomass of stemwood and bark in the top.

The number of harvested stems per ha is calculated by dividing the 13/7 volume
per ha by the 13/7 piece size.

## The average tree!

FMA holders are now required by Alberta to project average piece size in the 
detailed forest management plans for their FMAAs.  We use these piece sizes
projected for the first period of the DMFP.  They range from 0.110 to 0.599 m^3^
per tree.
The mean piece size for needleaf species is 0.278 m^3^ and 0.264 m^3^ for broadleaf
species.
For needleaf and broadleaf species to calculate the average dbh and height
for the most common species in each township for the group using the
taper functions from Ung *et al.* @Ung2013, by searching for the dbh
that yields these piece sizes for the FMAA utilization standards using
binary search.  For FMUs not associated
with an FMAA, or for FMAAs with plans written before this requirement we
use the average piece size from the DFMPs.

### Individual tree biomass.

Canada's national forest inventory website provides a useful individual
tree biomass calculator @NFIS2016.  It calculates the biomass of tree 
components (stem wood, stem bark, branches, foliage, and total) using
province/territory, terrestrial ecozon, species, dbh, and tree height as input.
It is possible to upload a file to the calculator so that the biomass of
many trees can be calculated at once.  The calculator is based on work
by Lambert *et al.* @Lambert2005.

We assume that the residual biomass is in the stem wood and stem bark from the
tops of the harvested trees and the branches and foliage.  The residual biomass
from the tops is calculated using the total biomass of stem wood and stem bark
adjusted by the volume proportions calculated above.


```{r read_data_files, echo=FALSE}
newAB <- read.csv(file = '../data/AlbertaHarvestLevels.csv',
                  fileEncoding = 'UTF-8-BOM')
t <- read.csv(file = '../data/township_merchantable_volume.csv')
twp_merch_vol <- t %>% select(c(TRM,mean_merch_volume)) 
twp_merch_vol$adj_vol <- twp_merch_vol$mean_merch_volume * merch_vol_adj_factor
#twp_merch_vol$residue_odmt <- twp_merch_vol$adj_vol * odmt_adj_factor
load("../data/biomass_by_trm.RData")
twp_merch_vol_temp <- merge(twp_merch_vol,biomass_by_trm,by = "TRM", all = TRUE)
twp_merch_vol <- twp_merch_vol_temp %>% 
  mutate(adj_factor = res_total/adj_vol)

mean(twp_merch_vol$adj_factor)

t <- read.csv(file = '../data/harvest_township_stats_melt_area.csv')
t <- subset(t, select = c(TRM,year,harvest_ha)) %>% filter(year >=1990)
t <- merge(t, twp_merch_vol, by = "TRM", all=TRUE)
t$adj_vol <- t$adj_vol %>% replace_na(0)  # there is an NAs problem here.  replace NAs with average.
                                              # is that the right way to do it?
t$unadj_harvest_vol <-t$harvest_ha * t$mean_merch_volume
t$harvest_vol <- t$harvest_ha * t$adj_vol 
t$residue_odmt <- t$harvest_ha * t$res_total
t <- t %>% 
  filter(!is.na(residue_odmt))


harv <- subset(t, harvest_ha > 0)
#head(harv)
#summary(harv$harvest_ha)
#summary(garv$harvest_vol) 
#summary(harv$adj_vol)

#harv2 <- aggregate(harv$harvest_vol,by=list(Category=harv$year), FUN=sum)
harv2 <- harv %>% group_by(year) %>%
  summarise(harvest_vol = sum(harvest_vol),
            unadj_harvest_vol = sum(unadj_harvest_vol))

# %>%
#   mutate(hvol2=rollapply(harvest_vol,5,mean,align='left',fill=NA))

#summary(harv2$harvest_vol)
#harv2
# ggplot(data=harv2, aes(x=year)) +
#   geom_line(aes(y = harvest_vol), colour="darkred") +
# #  geom_line(aes(y = harvvol), colour="steelblue") +
#   labs(x = "year") + labs(y = "harvest volume (million m3)")  +
#   scale_y_continuous(limits=c(0,30e6),labels = label_number(scale = 1/1e6))

#2009 is the median harvest volume year for Alberta in 1990-2015

# ggplot(data=harv2, aes(x=year,y=harvest_vol)) +
#   labs(x = "year") +
#   labs(y = "harvest volume (million m3)") +
#   geom_line()  +
#   scale_y_continuous(limits=c(0,30e6),labels = label_number(scale = 1/1e6))
# +
#   scale_colour_viridis(discrete = TRUE) +
#   theme(legend.position = "none") +
#   facet_grid(cols=vars(location)) +
#   scale_x_continuous(limits=c(0,800000),labels = label_number(scale = 1/1000))
harv3 <- read.csv(file = '../data/ABHarvestVol.csv') %>% filter(year >=1990)
#harv3 

harv4 <- merge(harv2, harv3, by = "year", all=TRUE)
harv5 <- merge(harv4, newAB, by = "year", all=TRUE)

# harv_comparison <- ggplot(data=harv5, aes(x=year,y=harvest_vol)) +
#   labs(x = "year") +
#   labs(y = bquote('harvest volume' ~(10^6 ~m^3))) +
#   geom_line()  +
#   geom_line(aes(y=total))  +
#   scale_y_continuous(limits=c(0,30e6),labels = label_number(scale = 1/1e6)) +
#   scale_x_continuous(limits=c(1990,2015)) + 
#   guides(fill=guide_legend(title="harvest volume"))

# harv_comparison <- ggplot(data=harv5, aes(x=year)) +
#   labs(x = "year") +
#   labs(y = bquote('harvest volume' ~(10^6 ~m^3))) +
#   geom_line(aes(y=harvest_vol))  +
#   geom_line(aes(y=total))  +
#   scale_y_continuous(limits=c(0,30e6),labels = label_number(scale = 1/1e6)) +
#   scale_x_continuous(limits=c(1990,2015)) + 
#   guides(fill=guide_legend(title="harvest volume"))
# 
# head(harv4)

harv5a <- harv5 %>% 
  select(year,harvest_vol,total) %>% 
  rename(actual = total, estimated = harvest_vol) %>% 
  pivot_longer(!year,names_to = "Volume", values_to = "sum")

harv_comparison <- ggplot(data=harv5a, aes(x = year,y = sum,colour = Volume)) + 
  labs(y = bquote('harvest volume' ~(10^6 ~m^3))) +
  geom_line(aes(y =  sum)) +
  scale_y_continuous(limits=c(0,30e6),labels = label_number(scale = 1/1e6)) +
  scale_x_continuous(limits=c(1990,2015)) +
  theme(legend.position = c(0.9,0.3))

t <- read.csv(file = '../data/interpolated_median_oneway_times_seconds.csv')

d <- pivot_longer(t,cols=c("edson_median","hinton_median","whitecourt_median"),names_to = "location")
d <- d %>% mutate(location=recode(location,whitecourt_median="Whitecourt",edson_median="Edson",hinton_median="Hinton"))
#d <- select(d, -sum)
d$cycleTime <- 2* (d$value/3600) + standing_time/60

d$residueCost <- d$cycleTime * truck_rate + prepiling_cost + comminution_cost + other_cost
d <- select(d, -value)

#head(d)

big_joined <- inner_join(d,harv, by = "TRM")
#head(big_joined)
#tail(big_joined)

cum.odmt <- big_joined %>%
  arrange(location,year,cycleTime) %>%
  group_by(location,year) %>%
  mutate(residue.cumsum=cumsum(residue_odmt))

#save(cum.odmt,file="../data/cum.odmt.RData")

cum.whitecourt2009 <- cum.odmt %>% 
  filter(location == "Whitecourt") %>% 
  filter(year == 2009) %>% 
  filter(residue.cumsum <= 800000) 

write.csv(file="../data/cum.whitecourt2009.csv",cum.whitecourt2009)

cum.whitecourt1990 <- cum.odmt %>% 
  filter(location == "Whitecourt") %>% 
  filter(year == 1990) %>% 
  filter(residue.cumsum <= 800000) 

write.csv(file="../data/cum.whitecourt1990.csv",cum.whitecourt1990)

cum.whitecourt2005 <- cum.odmt %>% 
  filter(location == "Whitecourt") %>% 
  filter(year == 2005) %>% 
  filter(residue.cumsum <= 800000) 

write.csv(file="../data/cum.whitecourt2005.csv",cum.whitecourt2005)


cum.hew <- cum.odmt %>% 
  select(TRM, location, cycleTime, year, residue.cumsum) %>% 
  filter(year == 2005 | year == 1990 | year == 2009) %>% 
  filter(residue.cumsum <= 800000) 

write.csv(file="../data/cum_3yrs_3towns.csv",cum.hew,row.names = FALSE)

```

As a check, we obtained harvest volumes from Alberta for the period 1990-2015 
from the national
forestry database @CCFM2021.  
Note that in 1998, industrial salvage volumes of 369 791 m^3^ of
softwood and 264 647 m^3^ are not included in the harvest levels 
shown in the graph.

<!-- ```{r harvbyowner, echo=FALSE, fig.cap="NFDP harvest levels by ownership.", out.width = '100%'} -->
<!-- knitr::include_graphics("../img/harvestbyowner.png") -->
<!-- ``` -->


# Results and Discussion


## Township level biomass


## Distributional results
```{r supply_curves, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Residue supply (cycle time) curves by plant location.  Each curve represents one year.  The red curves (from top to bottom) are for 1990, 2009, and 2005 which are the years of minimum, median, and maximum harvest volume in Alberta."}

cyclePlot <- 
  ggplot(data=cum.odmt, aes(x=residue.cumsum,y=cycleTime,group=year,colour=as.factor(year))) +
  labs(x = "cumulative residue (Gg )") +
  labs(y = "marginal cycle time (h)") +
  geom_line() +
  scale_colour_manual(values=c("Grey","Grey","Grey","Grey","Grey","Grey","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Grey","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Red","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Red","Red","Red")) +
#  scale_colour_viridis(discrete = TRUE) +
  geom_line(data=cum.odmt[cum.odmt$year==2009,],aes(x=residue.cumsum,y=cycleTime, colour="Red"))+
   geom_line(data=cum.odmt[cum.odmt$year==1990,],aes(x=residue.cumsum,y=cycleTime, colour="Red"))+
  geom_line(data=cum.odmt[cum.odmt$year==2005,],aes(x=residue.cumsum,y=cycleTime, colour="Red"))+
  theme(legend.position = "none") +
  facet_grid(cols=vars(location)) +
  scale_x_continuous(limits=c(0,800000),labels = label_number(scale = 1/1000))+
  scale_y_continuous(limits=c(0,14)) 


```


```{r more_supply_curves, echo=FALSE, warning=FALSE, message=FALSE,  fig.cap="Residue supply (marginal cost) curves by plant location.  Each curve represents one year.  The red curves (from top to bottom) are for 1990, 2009, and 2005 which are the years of minimum, median, and maximum harvest volume in Alberta."}
mcPlot <- 
  ggplot(data=cum.odmt, aes(x=residue.cumsum,y=residueCost,group=year,colour=as.factor(year))) +
  labs(x = "cumulative residue (Gg )") +
  labs(y = bquote('marginal cost ('~"$"%.%Mg^-1~')')) +
  geom_line() +
  scale_colour_manual(values=c("Grey","Grey","Grey","Grey","Grey","Grey","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Grey","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Red","Grey",
                               "Grey","Grey","Grey","Grey","Grey","Red","Red","Red")) +
#  scale_colour_viridis(discrete = TRUE) +
  geom_line(data=cum.odmt[cum.odmt$year==2009,],aes(x=residue.cumsum,y=residueCost, colour="Red"))+
  geom_line(data=cum.odmt[cum.odmt$year==1990,],aes(x=residue.cumsum,y=residueCost, colour="Red"))+
  geom_line(data=cum.odmt[cum.odmt$year==2005,],aes(x=residue.cumsum,y=residueCost, colour="Red"))+
  theme(legend.position = "none") +
  facet_grid(cols=vars(location)) +
  scale_x_continuous(limits=c(0,800000),labels = label_number(scale = 1/1000)) +
  scale_y_continuous(limits=c(50,250)) 
```



```{r boxplots, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Distribution of residue costs by location, capacity, and year"}
t200 <- cum.odmt %>% filter(residue.cumsum <= 200000)
t200$capacity <- 200
t400 <- cum.odmt %>% filter(residue.cumsum <= 400000)
t400$capacity <- 400
t800 <- cum.odmt %>% filter(residue.cumsum <= 800000)
t800$capacity <- 800

t <- bind_rows(t200,t400)
t <- bind_rows(t,t800)

t <- t %>%
  arrange(year,location, cycleTime) 

bPlot <- ggplot(t,aes(factor(year),residueCost))  + 
  geom_tufteboxplot() +  
  facet_grid(cols=vars(location),rows=vars(capacity)) +
  labs(y = bquote('cost ('~"$"%.%Mg^-1~')'))+
  labs(x = "year") + 
  scale_x_discrete(breaks=c("1990","","","","","1995","","","","","2000","","","","","2005","","","","","2010","","","","","2015")) +
  theme(axis.text.x = element_text(angle=90))

```


```{r avecosts, echo=FALSE, warning=FALSE, message=FALSE, fig.cap="Average costs by location, capacity, and year "}

t <- t %>%
  arrange(location, capacity, year)

avet <-t %>%
  group_by(location,capacity, year) %>%
  summarize(avecost = mean(residueCost))


avePlot <- ggplot(data=avet, aes(x=year,y=avecost,colour=location))+
  labs(x = "year") +
  labs(y = bquote('average cost ('~"$"%.%Mg^-1~')')) +
  geom_line() +
  facet_grid(rows=vars(capacity)) +
  scale_y_continuous(limits=c(60,200)) 

aveave <- avet %>%
  group_by(location,capacity) %>% 
  summarise(aveavecost = mean(avecost),
            sdavecost = sd(avecost))

aveave <- aveave %>% 
  mutate(cv = sdavecost/aveavecost)

ave <- aveave %>%
  gt() %>%
  tab_header(
    title = "summary stats"
    ) %>%
  fmt_number(
    columns = c(capacity,aveavecost,sdavecost,cv),
    suffixing = TRUE,
    n_sigfig = 3
  ) %>% 
  cols_label(location = "Location",
             capacity = "Capacity (Gg/a)",
             aveavecost = "Mean ($/Mg", 
             sdavecost = "Std. Dev. ($/Mg)", 
             cv = "C.V.") 

```

Figures 9 and 10 display marginal cycle time (h) and marginal costs ($·Mg^-1^)
for each of the 26 years in the study period, and for the 3 alternative plant 
locations.  Curves for 1990, 2009, and 2005 are highlighted represented the
years of minimum, median, and maximum provincial harvest volume in the period. 
The inter-year variation in marginal costs increases as the cumulative amount
of residue collected increases.  We can also see that the relative position of
the years in terms of cost varies between the plant locations:  *e.g.* the year 
2005 is not as good for Hinton, as it was for Edson and Whitecourt.

Figure 11 is another way of presenting the year to year variation in the 
distribution of costs between the plant locations and assumed capacity: the
boxplots display the quartiles and the minimum and maximum costs require to
supply a plant of a given capacity at each of the locations in each of the
years.  Here again, we can see the variability increasing as plant capacity
increases.

Figure 12 shows the average cost ($·Mg^-1^) for  each location, capacity, and
year.  Overall, the average costs in Edson and Whitecourt are quite similar.
Hinton is usually more expensive across years and capacities.  The differences
become clearer at a capacity of 800 Gg, where Whitecourt is the low cost location
for most of the years.


Table ?? presents summary statistics over the 26 year for the locations and 
capacities.  It is clear that average costs and the inter-annual variability of 
costs increase with increasing capacity.  It is clear that the variation is costs
for Hinton is greater than for Whitecourt and Edson, particularly for the 800
Gg/a capacities.




Figure 13 shows the areas that would have been needed to supply a plants of 
varying capacities in Whitecourt in the year of median harvest (2009) in 
relation to the proportional township area harvested.  There is some residue 
being collected from the White area, but most of it is being collected from the 
green area.

Figure 14 compares the supply areas for 2005, 2009, and 1990 (high, median, and
low harvest years).  The area required to supply the mills increases by a lot
in low timber harvest years, particularly for the 800 Gg/a capacity.  Similar
maps could be produced for the other locations and all 26 years, but that is
unecessary here.



<!-- A table aligned on decimal point. -->

<!-- \begin{tabular}{S[table-format=3.2]}% syntax for siunitx v2; for v1 use "tabformat" -->
<!-- 555 \\ -->
<!-- 7.77 \\ -->
<!-- 99.9 -->
<!-- \end{tabular} -->


<!-- Figure ?? displays the marginal cycle time for each of the locations over the -->
<!-- 26 years of the study period.  The year 2009 had the median overall harvest  -->
<!-- level in Alberta over that period, and is coloured red in order to illustrate -->
<!-- the marginal cycle time for a median year. -->



Whitecourt is low cost for most years at all capacities.  Noticable spike in
1999.  Probably due to Virginia Hills fire salvage.  Note that this spike
also affects Hinton and Edson at 800 Gg/a  capacity, 
because they reach into the 
Whitecourt area.

As expected, residue costs are lower with lower capacities because they don't have to reach
so far out.

# Conclusions

1. Spatial resolution between Yemshanov and FPInnovations

1. Demonstrated spatial and temporal variation in 
  availability of residue supply for plant
  locations of different capacities.  Mention average and marginal costs.

2. Demonstrated use of publicly available data to quantify this stuff.

3. Residue supply to large plants is more expensive and more variable than
 to smaller plants.  
 
Perhaps it makes sense to transport to smaller plants (e.g. pellets), and
then aggregate at a larger plant (e.g. ethanol).  Pellets are cheaper to 
transport than comminuted biomass.

# Data availability {-}

**Put the compiled data on ERA.  Point out links to other information**

# Acknowledgements {-}

This research was supported by funding from the Canada First Research Excellence
Fund as part of the University of Alberta’s Future Energy Systems 
research initiative.
<!-- (Project # CFREF-2015-00001) -->


Dennis Gray contributed to data compilation.

This work started as an extension to Irene Onyango's Master of Agriculture
research.

We work with a group of talented people.  Thanks to Marty Luckert, Feng Qiu,
Grant Hauer, and Wenbei Zhang for helpful discussion.

\newpage

# Reference list  {-}

<div id="refs"></div>

\newpage

# Tables {-}

<!-- Table:  Road speeds (km/h). -->

<!-- | Road class      | loaded | unloaded | harmonic mean |  -->
<!-- |:----------------|-------:|---------:|--------------:| -->
<!-- | primary highways|    80  |       95 |           85  | -->
<!-- | other paved     |    65  |       80 |           70  | -->
<!-- | 2-lane gravel   |    50  |       70 |           60  |  -->
<!-- | 1-lane gravel or dirt  |    20  |       30 |           25  |  -->
<!-- | no road           |     5  |       5  |           5   | -->

Table:  Road speeds based on FPInnovations (km/h).

| Road class      | loaded | unloaded | harmonic mean | 
|:----------------|-------:|---------:|--------------:|
| primary highways|    85  |       95 |           90  |
| other paved     |    77  |       86 |           81  |
| 2-lane gravel   |    60  |       67 |           63  | 
| 1-lane gravel or dirt  |    29  |       25 |           27  | 
| no road           |     5  |       5  |           5   |

Table:  blah blah blah

```{r ave, echo=FALSE}
ave
``` 

\newpage


# Figures {-}


```{r canada, echo=FALSE, fig.cap="Location of Alberta in Canada.", out.width = '100%'}
knitr::include_graphics("../img/canada.png")
```



```{r cutblocks2009, echo=FALSE, fig.cap="Harvest areas for 2009.", out.width = '80%'}
knitr::include_graphics("../img/cutblocks2009.png")
```


```{r harvesttwp, echo=FALSE, fig.cap="Harvest areas for 2009 with aggregated to township level.  Only those townships where the proportion of total area harvested was 0.001 or greater are shown", out.width = '80%'}
knitr::include_graphics("../img/harvesttwp.png")
```


\newpage
\blandscape
```{r merchvol, echo=FALSE, fig.cap="Merchantable volume by township.  The left panel indicates total merchantable volume in the township from the 250 m data, and the boundaries of Alberta's green and white areas.  The right panel indicates average harvestable volume (m³/ha) after non-merchantable stands have been filtered out.", out.width = '100%'}
knitr::include_graphics("../img/Merchantable Volume.png")
```
\elandscape
  
\newpage
\blandscape
```{r haul, echo=FALSE, fig.cap="Alberta road network (left) and one-way haul time (right) from Edson, limited to 6 hours.", out.width = '100%'}
knitr::include_graphics("../img/network_service.png")
```
\elandscape

<!-- ```{r studyarea, echo=FALSE, fig.cap="Location of hypothetical residue processing plants in relation to FMAA boundaries and the Green and White Areas of Alberta.", out.width = '80%'} -->
<!-- knitr::include_graphics("../img/study_area.png") -->
<!-- ``` -->


<!-- ```{r ecozones, echo=FALSE, fig.cap="Terrestrial ecozones of Canada within Alberta.", out.width = '80%'} -->
<!-- knitr::include_graphics("../img/ecozonesAlex.png") -->
<!-- ``` -->

\newpage
\blandscape
```{r pressure, echo=FALSE, fig.cap="NFDP harvest levels compared with estimated.", out.width = '100%'}
suppressWarnings(print(harv_comparison))
```
\elandscape

```{r residue, echo=FALSE, fig.cap="Biomass residue available from harvest.", out.width = '100%'}
knitr::include_graphics("../img/residue.png")
```


\newpage
\blandscape
```{r cyclePlot, echo=FALSE, fig.cap="Distribution of cycle times by location for each of the years 1990--2015.  The middle red curve is for a medium harvest level year (2009), the lower red curve is for a high harvest level year (2005), and the upper red curve is for a low harvest level year (1990).", out.width = '100%'}
suppressWarnings(print(cyclePlot))
```
\elandscape


\newpage
\blandscape
```{r mcpPlot, echo=FALSE, fig.cap="Distribution of marginal costs by location for each of the years 1990--2015.  The middle red curve is for a medium harvest level year (2009), the lower red curve is for a high harvest level year (2005), and the upper red curve is for a low harvest level year (1990).", out.width = '100%'}
suppressWarnings(print(mcPlot))
```
\elandscape

\newpage
\blandscape
```{r bPlot, echo=FALSE, fig.cap="Boxplots of costs by location and biomass requirements for the years 1990--2015.", out.width = '100%'}
suppressWarnings(print(bPlot))
```
\elandscape

\newpage
\blandscape
```{r avePlot, echo=FALSE, fig.cap="Average costs by location and year.", out.width = '100%'}
suppressWarnings(print(avePlot))
```
\elandscape


```{r w2009, echo=FALSE, fig.cap="Relationship between timber harvest intensity and required supply area for facilities with biomass requirements of 200, 400, and 800 Gg/a.  The area of the dots reflects the proportion of the area of each township harvest in 2009", out.width = '100%'}
knitr::include_graphics("../img/w2009.png")
```

\newpage
\blandscape
```{r wcontour, echo=FALSE, fig.cap="Supply area for facilities in Whitecourt with biomass requirements of 200, 400, and 800 Gg/a for low cost (2005), medium cost (2009), and high cost (1990) years.", out.width = '100%'}
knitr::include_graphics("../img/Cumulative Contours Whitecourt.png")
```
\elandscape